<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login - Elo Digital</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background-color: #7B2CBF; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
        .card { background: white; padding: 40px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); width: 90%; max-width: 350px; text-align: center; }
        h2 { color: #333; margin-bottom: 20px; font-size: 1.4rem; }
        input { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 10px; box-sizing: border-box; margin-bottom: 15px; outline: none; }
        .btn-main { width: 100%; padding: 15px; background-color: #E63946; color: white; border: none; border-radius: 10px; font-weight: bold; cursor: pointer; }
        .toggle-link { display: block; margin-top: 20px; color: #7B2CBF; text-decoration: none; font-size: 0.85rem; cursor: pointer; }
    </style>
</head>
<body>
    <div class="card" id="authCard">
        <h2 id="title">Entrar no App</h2>
        <input type="email" id="email" placeholder="Seu e-mail">
        <input type="password" id="senha" placeholder="Sua senha">
        <button class="btn-main" onclick="processarAuth()" id="btnAcao">ENTRAR</button>
        <p class="toggle-link" onclick="alternarModo()" id="toggleText">Não tem conta? Criar agora</p>
    </div>

    <script>
        let modoLogin = true;
        const API_URL = "https://thiago19932-elo-digital-33.deno.dev";

        function alternarModo() {
            modoLogin = !modoLogin;
            document.getElementById('title').innerText = modoLogin ? "Entrar no App" : "Criar Nova Conta";
            document.getElementById('btnAcao').innerText = modoLogin ? "ENTRAR" : "CADASTRAR";
            document.getElementById('toggleText').innerText = modoLogin ? "Não tem conta? Criar agora" : "Já tenho conta. Entrar";
        }

        async function processarAuth() {
            const email = document.getElementById('email').value;
            const senha = document.getElementById('senha').value;
            const rota = modoLogin ? "/login" : "/registrar";

            try {
                const res = await fetch(API_URL + rota, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email, senha })
                });

                const data = await res.json();
                if (res.ok) {
                    alert(modoLogin ? "Bem-vindo!" : "Conta criada com sucesso!");
                    localStorage.setItem('usuarioLogado', email);
                    window.location.href = "index.html";
                } else {
                    alert("Erro: " + data.erro);
                }
            } catch (e) { alert("Erro de conexão com o servidor."); }
        }
    </script>
</body>
</html>